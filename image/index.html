<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Miru image editor demo</title>
    <script type="module" src="/packages/webgl-media-editor/index.ts"></script>
    <style>
      :root {
        font-family: Inter, system-ui, Avenir, Helvetica, Arial, sans-serif;
      }
    </style>
  </head>
  <body class="m-0 @dark:bg-black @dark:text-#9ca3af bg-white text-black">
    <div class="flex flex-col w-full h-100vh overflow-hidden max-w-1440px m-auto">
      <div class="flex justify-between px-4 py-2">
        <div></div>
        <div></div>
        <div></div>
      </div>

      <div class="flex flex-1 px-4 gap-2rem min-h-0">
        <div class="flex flex-col gap-1rem w-25% min-h-0 <md:hidden">
          <pre id="errors" class="p-8 whitespace-pre-wrap"></pre>
        </div>

        <div class="flex flex-col overflow-auto flex-1 min-w-0 min-h-0 gap-12px">
          <media-editor id="imageEditor" class="min-h-0"></media-editor>

          <label
            class="flex flex-grow-0 justify-center items-center mx-auto px-2 py-1 cursor-pointer border-solid rounded-lg"
          >
            Change image
            <div class="i-tabler:photo text-2rem"></div>
            <!-- Select File -->
            <input style="max-width: 0" id="fileInput" type="file" accept="image/*" />
          </label>
        </div>

        <div class="flex flex-col gap-1rem w-25% <md:hidden"></div>
      </div>
    </div>

    <script type="module">
      import 'uno.css'
      import sampleImage from '/packages/shared/assets/Splendid_Fairywren_8352_portrait.jpg'

      const editor = document.getElementById('imageEditor')

      editor.sources = [sampleImage]

      const fileInput = document.getElementById('fileInput')
      fileInput.addEventListener('input', function (event) {
        const file = event.target.files?.[0]
        if (!file) return
        editor.sources = [file]
        event.target.value = null
      })

      window.onerror = (event, ...args) => {
        document.getElementById('errors').textContent = [event.toString(), args[2]?.stack]
          .filter(Boolean)
          .join('\n')
      }
    </script>
  </body>
</html>
